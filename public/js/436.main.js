"use strict";(self.webpackChunklistapp=self.webpackChunklistapp||[]).push([[436],{436:(e,t,n)=>{n.r(t),n.d(t,{showMypage:()=>o,mode:()=>i});const o=()=>{const e=new XMLHttpRequest;e.open("GET","/template/mypage.html",!0),e.onload=()=>{if(e.status>=200&&e.status<400){const t=e.responseText;document.getElementById("main").innerHTML=t,r()}},e.send()};let i,s=[],c=[],l=[],a=[],d=[],m=[];const r=async()=>{u("view");const{getAuth:e,onAuthStateChanged:t}=await Promise.all([n.e(238),n.e(167)]).then(n.bind(n,167)),{routing:o}=await Promise.resolve().then(n.bind(n,779));t(e(),(e=>{e&&"/mypage"===location.pathname?((async()=>{const{getUserData:t}=await n.e(938).then(n.bind(n,938));s=await t(e.uid),c=JSON.stringify(s),c=JSON.parse(c);const o=e.reloadUserInfo.providerUserInfo[0];s.user_name=o.displayName,s.user_icon=o.photoUrl,s.twitter_disp_id=o.screenName;const{setUserData:i}=await n.e(660).then(n.bind(n,660));i(s)})(),(async()=>{const{getLists:t}=await n.e(561).then(n.bind(n,561));l=await t(e.uid),y(),0==l.length?document.getElementById("my-list-unregistered").style.display="block":document.getElementById("my-list-unregistered").style.display="none",a=JSON.stringify(l),a=JSON.parse(a)})(),p(e.uid)):o("")}))},u=async e=>{const{setView:t}=await n.e(660).then(n.bind(n,660));i=e,t(e)},y=async()=>{document.getElementById("yet-list-container").innerHTML="",document.getElementById("done-list-container").innerHTML="",d=l.filter((e=>!e.check&&!e.remove)),d.sort(((e,t)=>e.order-t.order)),d.forEach(((e,t)=>{e.order=t,g(e.iid,e.name,e.check)})),m=l.filter((e=>e.check&&!e.remove));const{Timestamp:e}=await Promise.all([n.e(238),n.e(591)]).then(n.bind(n,591));m=m.map((t=>null==t.check_date?(t.check_date=e.now(),t):t)),m.sort(((e,t)=>e.check_date-t.check_date)),m.forEach((e=>{g(e.iid,e.name,e.check)}))},p=async e=>{document.getElementById("my-share-button-img").onclick=async()=>{document.getElementById("my-popup").style.display="flex"},document.getElementById("my-edit-button-img").onclick=()=>{u("edit")},document.getElementById("my-title"),document.getElementById("my-title").oninput=e=>{s.list_title=e.target.value},document.getElementById("my-bio-text"),document.getElementById("my-bio-textarea").oninput=e=>{e.target.offsetHeight<e.target.scrollHeight&&(e.target.style.height=e.target.scrollHeight+"px"),s.user_bio=e.target.value},document.getElementById("add-list-wrapper").onclick=()=>{document.getElementById("my-text-edit-area").value="",u("add")};let t=0;document.getElementById("my-add-submit-button").onclick=async()=>{let e=document.getElementById("my-text-edit-area").value;e&&(d.push({iid:t.toString(),name:e,check:!1,remove:!1,order:d.length}),g(t.toString(),e,!1),t++),u("edit")},document.getElementById("my-rename-submit-button").onclick=async()=>{let e=document.getElementById("my-text-edit-area");e.value&&(d.find((t=>t.iid===e.name)).name=e.value,document.querySelector("#iid-"+e.name+" .list-text-box").innerHTML=e.value),u("edit")},document.getElementById("my-input-cancel").onclick=async()=>{u("edit")},document.getElementById("my-edit-cancel-button-img").onclick=async()=>{l=JSON.stringify(a),l=JSON.parse(l),y(),u("view")},document.getElementById("my-save-button-img").onclick=async()=>{const t=document.getElementById("yet-list-container").children,o=t.length;for(let e=0;e<o;e++)d.find((({iid:n})=>n===t[e].id.substr(4))).order=o-e-1;const{saveData:i}=await n.e(561).then(n.bind(n,561));await i(e,d,m),l=d.concat(m);const{checkUserData:a,updateUserData:r}=await n.e(938).then(n.bind(n,938));a(c,s)&&r(s),document.getElementById("my-popup").style.display="flex",0==l.length?document.getElementById("my-list-unregistered").style.display="block":document.getElementById("my-list-unregistered").style.display="none",y(),u("view"),setTimeout((async()=>{const{getLists:t}=await n.e(561).then(n.bind(n,561));l=await t(e),d=l.filter((e=>!e.check&&!e.remove))}),1e3)},document.getElementById("my-popup-twitter").onclick=()=>{document.getElementById("my-popup").style.display="none";const t="https://campa-room.web.app/show/"+e;location.href="http://twitter.com/share?url="+t+"&text=行きたいとこリストを更新しました!&hashtags=行きたいとこリスト"},document.getElementById("my-popup-copylink").onclick=()=>{document.getElementById("my-popup").style.display="none",navigator.clipboard.writeText("https://campa-room.web.app/show/"+e)},document.getElementById("my-popup-close").onclick=()=>{document.getElementById("my-popup").style.display="none"}},g=async(e,t,n)=>{const o=document.getElementById("yet-list-container"),s=document.getElementById("done-list-container"),c=document.createElement("div");c.setAttribute("class","list-parent"),c.setAttribute("id","iid-"+e);const l=document.createElement("div");l.setAttribute("class","list-delete-button"),c.appendChild(l);const a=document.createTextNode("削除");l.appendChild(a);const r=document.createElement("div");r.setAttribute("class","list-wrapper"),c.appendChild(r);const y=document.createElement("img");n?(y.setAttribute("src","/data/done.svg"),y.setAttribute("class","list-check-box-done")):(y.setAttribute("src","/data/yet.svg"),y.setAttribute("class","list-check-box-yet"),y.onclick=()=>{if("edit"==i){const t=d.find((t=>t.iid===e));t.check?(y.setAttribute("src","/data/yet.svg"),t.check=!1):(y.setAttribute("src","/data/done.svg"),t.check=!0)}}),r.appendChild(y);const p=document.createElement("div");n?p.setAttribute("class","list-text-box"):p.setAttribute("class","list-text-box my-editable");const g=document.createTextNode(t);if(p.appendChild(g),p.style.color=n?"#C3C3C3":"#000",r.appendChild(p),!n){const e=document.createElement("img");e.setAttribute("src","/data/sort.svg"),e.setAttribute("class","list-sort-button my-edit-mode"),r.appendChild(e),e.ontouchstart=t=>{const n=t.touches[0].clientX,s=t.touches[0].pageY;let l=!0,a=0,d=0;document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",e.ontouchmove=e=>{if("edit"===i&&(50<Math.abs(e.touches[0].clientX-n)&&(l=!1),l)){if(c.style.zIndex=1,a=e.touches[0].pageY-s+d,c==o.firstChild&&a<0)a=0;else if(c==o.lastChild&&0<a)a=0;else if(a<-60){d+=60;const e=c.previousElementSibling;let t=-60;const n=()=>{-10<t?t=0:(requestAnimationFrame(n),t+=10),e.style.top=t+"px"};n(),o.insertBefore(c,e)}else if(60<a){d-=60;const e=c.nextElementSibling;let t=60;const n=()=>{t<10?t=0:(requestAnimationFrame(n),t-=10),e.style.top=t+"px"};n(),o.insertBefore(c,e.nextSibling)}c.style.top=a+"px"}},e.ontouchend=()=>{document.documentElement.style.overflow="auto",document.body.style.overflow="auto",c.style.top=0,c.style.zIndex=0}}}n||(p.onclick=()=>{if("edit"===i){const t=d.find((t=>t.iid===e));document.getElementById("my-text-edit-area").value=t.name,document.getElementById("my-text-edit-area").name=e,u("rename")}}),r.ontouchstart=e=>{r.style.background="#EEE";const t=r.offsetLeft,n=e.touches[0].clientX,o=e.touches[0].pageY;let s=!0;r.ontouchmove=e=>{if("edit"===i&&(50<Math.abs(e.touches[0].pageY-o)&&(s=!1),s)){let o=t+e.touches[0].clientX-n;-100<o&&o<0&&(r.style.left=o+"px")}},r.ontouchend=()=>{if(r.style.background="#FFF","edit"===i&&r.offsetLeft<0){const e=()=>{-3<r.offsetLeft?r.style.left="0px":-50<r.offsetLeft?(requestAnimationFrame(e),r.style.left=r.offsetLeft+5+"px"):-100<r.offsetLeft?(requestAnimationFrame(e),r.style.left=r.offsetLeft-5+"px"):r.style.left="-100px"};e()}}},l.onclick=()=>{const e=d.find((e=>e.iid===l.parentElement.id.substr(4)));void 0!==e?e.remove=!0:m.find((e=>e.iid===l.parentElement.id.substr(4))).remove=!0;let t=60;const n=()=>{0<t?requestAnimationFrame(n):l.parentElement.style.display="none",r.style.left=r.offsetLeft-20+"px",t-=5,l.parentElement.style.height=t+"px"};n()},document.addEventListener("touchstart",(e=>{if(e.target!==l&&e.target!==r){const e=()=>{-3<r.offsetLeft?r.style.left="0px":(requestAnimationFrame(e),r.style.left=r.offsetLeft+10+"px")};e()}})),n?s.insertBefore(c,s.firstChild):o.insertBefore(c,o.firstChild)}}}]);